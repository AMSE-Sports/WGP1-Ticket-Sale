<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>WGP#1 — Visitor & Staff Registration</title>
  <meta name="color-scheme" content="light only">
  <style>
    :root { --primary:#f37021; --border:#ececec; --ok:#16a34a; --err:#dc2626; }
    * { box-sizing:border-box; }
    body { margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif; background:#fafafa; color:#111; }
    .wrap { max-width:960px; margin:0 auto; padding:16px; }
    .card { border:1px solid var(--border); border-radius:16px; overflow:hidden; background:#fff; box-shadow:0 10px 24px -18px rgba(0,0,0,.25); }
    .head { padding:14px 16px; border-bottom:1px solid var(--border); display:flex; align-items:center; justify-content:space-between; gap:12px; }
    .brand { display:flex; align-items:center; gap:10px; }
    .brand-badge { width:40px;height:40px;border-radius:10px;background:var(--primary);color:#fff;display:flex;align-items:center;justify-content:center;font-weight:900;letter-spacing:.5px; }
    .body { padding:16px; }
    .row { display:grid; gap:12px; grid-template-columns:1fr; }
    @media (min-width:760px) { .row.two { grid-template-columns:1fr 1fr; } }
    label { font-weight:700; font-size:13px; display:block; margin-bottom:6px; }
    input, select { width:100%; padding:12px; border-radius:12px; border:1px solid var(--border); outline:none; }
    input:focus, select:focus { border-color:var(--primary); box-shadow:0 0 0 3px rgba(243,112,33,.2); }
    .btn { display:inline-flex; gap:10px; align-items:center; font-weight:800; border:0; padding:16px 20px; border-radius:16px; cursor:pointer; transition:transform .02s ease-in; }
    .btn:active { transform:translateY(1px); }
    .btn.primary { background:var(--primary); color:#fff; box-shadow:0 10px 24px -16px rgba(243,112,33,.85); }
    .btn.dark { background:#111; color:#fff; }
    .btn.ghost { background:#fff; color:#111; border:1px solid var(--border); }
    .btn.wide { width:100%; justify-content:center; font-size:16px; }
    .thank { text-align:center; padding:40px 20px; color:#fff; background:linear-gradient(135deg, var(--primary), #ff8c4a); }
    .thank h2 { margin:0 0 10px; font-size:28px; }
    .thank p { margin:0; font-size:16px; opacity:.95; }
    .sub { color:#666; font-size:12px; margin-top:4px; }
    .consent-check { display:flex; gap:10px; align-items:flex-start; }
    .toast { position:fixed; right:14px; bottom:14px; background:#111; color:#fff; padding:10px 12px; border-radius:10px; display:none; z-index:9999; }
    .hidden { display:none; }
    .hero { border:0; }
    .footer { text-align:center; font-size:12px; color:#666; padding:20px 0; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card hero">
      <img src="Header.png" alt="WGP#1 Header" style="width:100%;height:auto;display:block;border-bottom:1px solid #eee;">
      <div class="head">
        <div class="brand">
          <div class="brand-badge">W</div>
          <div>
            <div style="font-weight:800;">WGP#1 Waterjet World Cup 2025</div>
            <div style="font-size:12px;color:#666;">Visitor Registration & Staff Ticket Entry</div>
          </div>
        </div>
        <div style="font-size:12px;color:#666;">Jomtien Beach, Pattaya • 17–21 Dec 2025</div>
      </div>
    </div>

    <!-- VIEW 1: VISITOR -->
    <section id="v1" class="card" style="margin-top:16px;">
      <div class="head"><h2 style="margin:0;">ส่วนที่ 1 — ผู้ชม (Visitor)</h2></div>
      <form class="body" id="visitor-form" autocomplete="on">
        <div class="row">
          <div>
            <label>อีเมล *</label>
            <input id="v-email" type="email" required placeholder="name@example.com" autocomplete="email">
          </div>
        </div>
        <div class="row two">
          <div><label>ชื่อจริง *</label><input id="v-first" required autocomplete="given-name"></div>
          <div><label>นามสกุล *</label><input id="v-last" required autocomplete="family-name"></div>
        </div>
        <div class="row two">
          <div>
            <label>เพศ *</label>
            <select id="v-gender" required>
              <option value="">— เลือกเพศ —</option>
              <option value="male">ชาย</option><option value="female">หญิง</option><option value="unspecified">ไม่ระบุ</option>
            </select>
          </div>
          <div>
            <label>อายุ *</label>
            <select id="v-age" required>
              <option value="">— เลือกช่วงอายุ —</option>
              <option>ต่ำกว่า 18 ปี</option><option>18-25 ปี</option><option>26-40 ปี</option><option>41-60 ปี</option><option>60 ปีขึ้นไป</option>
            </select>
          </div>
        </div>
        <div class="row two">
          <div>
            <label>ประเทศที่อาศัย *</label>
            <select id="v-country" required></select>
          </div>
          <div>
            <label>เมืองที่อาศัย *</label>
            <input id="v-city" required pattern="[\u0E00-\u0E7F a-zA-Z-]+" placeholder="เช่น Pattaya / กรุงเทพฯ">
            <div class="sub">รองรับอักษรไทย/อังกฤษและช่องว่างเท่านั้น</div>
          </div>
        </div>
        <div class="row" id="thai-province-row" style="display:none">
          <div>
            <label>จังหวัดที่อาศัยในประเทศไทย *</label>
            <select id="v-province"></select>
          </div>
        </div>
        <div class="row">
          <div>
            <label>คุณทราบข่าวจากสื่อใด *</label>
            <select id="v-source" required>
              <option value="">— เลือกช่องทาง —</option>
              <option value="pattaya-promotions">From Promotions in Pattaya จากการประชาสัมพันธ์ในเมือง</option>
              <option value="online-media">From online media จากช่องทางออนไลน์</option>
              <option value="news-tv">From news and TV จาก หนังสือพิมพ์ หรือโทรทัศน์</option>
              <option value="world-series-2025">From the World Series 2025 จากงาน เวิล์ดซีรีส์ 2025</option>
              <option value="friend">From a Friend or Acquaintance จากเพื่อนหรือคนรู้จัก</option>
            </select>
          </div>
        </div>
        <div class="row">
          <div>
            <label>ความยินยอม *</label>
            <div class="consent-check">
              <input type="checkbox" id="v-consent" required>
              <span>
                <strong>ฉันได้อ่านและยินยอมตามเงื่อนไขข้างต้น • I have read and consent</strong><br>
                <em>EN:</em> By attending the WGP#1 Waterjet World Cup 2025, which includes live broadcasting and global media coverage, you grant the event organizers and their partners the right to photograph, film, and record your image and voice for use in promotions, advertising, live streams, and other media—without the need for further consent or compensation. Entering the event area constitutes full and unconditional consent. If you do not wish to appear in such media, please avoid camera zones or broadcast areas.<br>
                <em>TH:</em> ในการเข้าชมการแข่งขัน WGP#1 Waterjet World Cup 2025 ซึ่งมีการถ่ายทอดสดและเผยแพร่สู่สาธารณะทั่วโลก ท่านยินยอมให้ผู้จัดงานและพันธมิตร สามารถบันทึกภาพนิ่ง วิดีโอ และเสียงของท่าน เพื่อใช้ในสื่อประชาสัมพันธ์ โฆษณา ถ่ายทอดสด และสื่ออื่น ๆ โดยไม่ต้องขออนุญาตหรือจ่ายค่าตอบแทนใด ๆ เพิ่มเติม การเข้าสู่พื้นที่จัดงาน ถือเป็นการให้ความยินยอมโดยสมบูรณ์ หากไม่ประสงค์ให้ถูกบันทึกภาพ โปรดหลีกเลี่ยงบริเวณกล้องหรือพื้นที่ถ่ายทอดสด
              </span>
            </div>
          </div>
        </div>
        <button class="btn primary wide" type="submit" aria-label="Confirm Visitor">ยืนยันข้อมูลผู้ชม • Confirm Visitor Details</button>
      </form>
    </section>

    <!-- VIEW 2: THANK YOU (Visitor) -->
    <section id="v2" class="card hidden" style="margin-top:16px;">
      <div class="thank">
        <h2>THANK YOU!</h2>
        <p>Thank you for being part of this world-class competition — we hope you enjoy an unforgettable and thrilling experience!</p>
        <p style="margin-top:6px;">ขอบคุณที่ร่วมเป็นส่วนหนึ่งของการแข่งขันระดับโลกครั้งนี้ — ขอให้คุณสนุกกับประสบการณ์สุดมันส์!</p>
      </div>
      <div class="body" style="text-align:center">
        <button class="btn dark" id="to-staff">ดำเนินการต่อสำหรับเจ้าหน้าที่</button>
      </div>
    </section>

    <!-- VIEW 3: STAFF -->
    <section id="v3" class="card hidden" style="margin-top:16px;">
      <div class="head"><h2 style="margin:0;">ส่วนที่ 2 — เจ้าหน้าที่ (Staff)</h2></div>
      <form class="body" id="staff-form" autocomplete="off">
        <div class="row two">
          <div>
            <label>เจ้าหน้าที่ *</label>
            <select id="s-staff" required>
              <option value="">— เลือกเจ้าหน้าที่ —</option>
              <option>เจ้าหน้าที่ A</option><option>เจ้าหน้าที่ B</option><option>เจ้าหน้าที่ C</option>
              <option>เจ้าหน้าที่ D</option><option>เจ้าหน้าที่ E</option><option>เจ้าหน้าที่ F</option>
            </select>
          </div>
          <div>
            <label>ตั๋วประเภท *</label>
            <select id="s-ticket" required>
              <option value="">— เลือกประเภทตั๋ว —</option>
              <option value="250-17" data-price="250">250฿ - One Day - Wed 17th</option>
              <option value="250-18" data-price="250">250฿ - One Day - Thu 18th</option>
              <option value="250-19" data-price="250">250฿ - One Day - Fri 19th</option>
              <option value="350-20" data-price="350">350฿ - One Day - Sat 20th</option>
              <option value="350-21" data-price="350">350฿ - One Day - Sun 21th</option>
              <option value="400-wed-fri" data-price="400">400฿ - 3 Days - Weekday (Wed-Fri)</option>
              <option value="500-weekend" data-price="500">500฿ - 2 Days - Pro Weekend (Sat - Sun)</option>
              <option value="750-all" data-price="750">750฿ - 5 Days - All Event (Wed-Sun)</option>
            </select>
          </div>
        </div>
        <div class="row two">
          <div><label>จำนวนตั๋วที่ซื้อ *</label><input id="s-qty" type="number" min="1" step="1" required placeholder="เช่น 1, 2, 3"></div>
          <div><label>ยอดชำระเงิน (THB) *</label><input id="s-amount" type="number" min="0" step="1" required placeholder="เช่น 500"></div>
        </div>
        <div class="row">
          <div>
            <label>ช่องทางการชำระ *</label>
            <label style="margin-right:12px;"><input type="radio" name="pay" value="เงินสด" required> เงินสด</label>
            <label><input type="radio" name="pay" value="โอนจ่าย"> โอนจ่าย</label>
          </div>
        </div>

        <div style="display:flex; gap:10px; flex-wrap:wrap">
          <button class="btn primary" id="finalize" type="submit">Finalize Registration</button>
          <button class="btn ghost" id="finalize-fallback" type="button" title="ใช้เมื่ออินเทอร์เน็ต/บราวเซอร์บล็อก fetch">ส่งแบบสำรอง (HTML POST)</button>
        </div>

        <!-- PURE HTML FALLBACK FORM (hidden, direct to Formspree) -->
        <form id="fallback-form" action="https://formspree.io/f/mrbrbzwo" method="POST" class="hidden">
          <input type="hidden" name="submittedAt" id="f-submittedAt">
          <input type="hidden" name="visitor_email" id="f-v-email">
          <input type="hidden" name="visitor_firstName" id="f-v-first">
          <input type="hidden" name="visitor_lastName" id="f-v-last">
          <input type="hidden" name="visitor_gender" id="f-v-gender">
          <input type="hidden" name="visitor_ageRange" id="f-v-age">
          <input type="hidden" name="visitor_country" id="f-v-country">
          <input type="hidden" name="visitor_city" id="f-v-city">
          <input type="hidden" name="visitor_thaiProvince" id="f-v-province">
          <input type="hidden" name="visitor_source" id="f-v-source">
          <input type="hidden" name="visitor_consent" id="f-v-consent">
          <input type="hidden" name="staff_staffName" id="f-s-staff">
          <input type="hidden" name="staff_ticketType" id="f-s-ticket">
          <input type="hidden" name="staff_ticketQty" id="f-s-qty">
          <input type="hidden" name="staff_amountPaid" id="f-s-amount">
          <input type="hidden" name="staff_payMethod" id="f-s-pay">
        </form>
      </form>
    </section>

    <!-- VIEW 4: COMPLETE (Staff) -->
    <section id="v4" class="card hidden" style="margin-top:16px;">
      <div class="thank" style="background:linear-gradient(135deg,#16a34a,#4ade80)">
        <h2>COMPLETE ✅</h2>
        <p>ดำเนินการเสร็จสิ้นแล้ว — พร้อมรับผู้ชมคนถัดไป</p>
      </div>
      <div class="body" style="text-align:center">
        <button class="btn primary" id="back-to-start">กลับไปเริ่มใหม่</button>
      </div>
    </section>

    <div class="footer">© 2025 WGP#1</div>
    <div class="toast" id="toast"></div>
  </div>

<script>
const FORMSPREE_ENDPOINT = "https://formspree.io/f/mrbrbzwo";

// Countries + Provinces
const COUNTRIES = ["Thailand","Afghanistan","Albania","Algeria","Andorra","Angola","Argentina","Armenia","Australia","Austria","Azerbaijan","Bahamas","Bahrain","Bangladesh","Barbados","Belarus","Belgium","Belize","Benin","Bhutan","Bolivia","Bosnia and Herzegovina","Botswana","Brazil","Brunei","Bulgaria","Cambodia","Canada","Chile","China","Colombia","Costa Rica","Croatia","Cuba","Cyprus","Czechia","Denmark","Dominican Republic","Ecuador","Egypt","Estonia","Finland","France","Germany","Greece","Hong Kong","Hungary","Iceland","India","Indonesia","Iran","Iraq","Ireland","Israel","Italy","Jamaica","Japan","Jordan","Kenya","Kuwait","Laos","Latvia","Lebanon","Lithuania","Luxembourg","Malaysia","Maldives","Mexico","Monaco","Mongolia","Morocco","Myanmar","Nepal","Netherlands","New Zealand","Nigeria","Norway","Oman","Pakistan","Philippines","Poland","Portugal","Qatar","Romania","Russia","Saudi Arabia","Singapore","Slovakia","Slovenia","South Africa","South Korea","Spain","Sri Lanka","Sweden","Switzerland","Taiwan","Turkey","Ukraine","United Arab Emirates","United Kingdom","United States","Vietnam","Zimbabwe"];
const THAI_PROVINCES = ["กรุงเทพมหานคร","กระบี่","กาญจนบุรี","กาฬสินธุ์","กำแพงเพชร","ขอนแก่น","จันทบุรี","ฉะเชิงเทรา","ชลบุรี","ชัยนาท","ชัยภูมิ","ชุมพร","เชียงราย","เชียงใหม่","ตรัง","ตราด","ตาก","นครนายก","นครปฐม","นครพนม","นครราชสีมา","นครศรีธรรมราช","นครสวรรค์","นนทบุรี","นราธิวาส","น่าน","บึงกาฬ","บุรีรัมย์","ปทุมธานี","ประจวบคีรีขันธ์","ปราจีนบุรี","ปัตตานี","พระนครศรีอยุธยา","พังงา","พัทลุง","พิจิตร","พิษณุโลก","เพชรบุรี","เพชรบูรณ์","แพร่","พะเยา","ภูเก็ต","มหาสารคาม","มุกดาหาร","แม่ฮ่องสอน","ยโสธร","ยะลา","ร้อยเอ็ด","ระนอง","ระยอง","ราชบุรี","ลพบุรี","ลำปาง","ลำพูน","ศรีสะเกษ","สกลนคร","สงขลา","สตูล","สมุทรปราการ","สมุทรสงคราม","สมุทรสาคร","สระแก้ว","สระบุรี","สิงห์บุรี","สุโขทัย","สุพรรณบุรี","สุราษฎร์ธานี","สุรินทร์","หนองคาย","หนองบัวลำภู","อ่างทอง","อำนาจเจริญ","อุดรธานี","อุตรดิตถ์","อุทัยธานี","อุบลราชธานี"];

function toast(t){ const x=document.getElementById('toast'); x.textContent=t; x.style.display='block'; clearTimeout(x._h); x._h=setTimeout(()=>x.style.display='none',3000); }
function show(id){ ["v1","v2","v3","v4"].forEach(i=>document.getElementById(i).classList.add('hidden')); document.getElementById(id).classList.remove('hidden'); window.scrollTo({top:0,behavior:'smooth'}); }

document.addEventListener('DOMContentLoaded', () => {
  // build countries
  const c = document.getElementById('v-country');
  c.innerHTML = '<option value="">— เลือกประเทศ —</option>' + COUNTRIES.map(x=>`<option>{x}</option>`).join('');
  c.value = 'Thailand';

  // build provinces
  const pr = document.getElementById('v-province');
  pr.innerHTML = THAI_PROVINCES.map(x=>`<option>{x}</option>`).join('');
  const row = document.getElementById('thai-province-row');
  function toggleProv(){ const isTH = (c.value==='Thailand' || c.value==='ไทย'); row.style.display = isTH ? 'grid':'none'; pr.required = !!isTH; if(!isTH) pr.value=''; }
  c.addEventListener('change', toggleProv); toggleProv();
});

// Visitor submit → Thank you
document.getElementById('visitor-form').addEventListener('submit', (e)=>{
  e.preventDefault();
  show('v2');
});

document.getElementById('to-staff').addEventListener('click', ()=>show('v3'));

// Staff submit (AJAX)
document.getElementById('staff-form').addEventListener('submit', async (e)=>{
  e.preventDefault();
  const payload = {
    visitor: {
      email: document.getElementById('v-email').value.trim(),
      firstName: document.getElementById('v-first').value.trim(),
      lastName: document.getElementById('v-last').value.trim(),
      gender: document.getElementById('v-gender').value,
      ageRange: document.getElementById('v-age').value,
      country: document.getElementById('v-country').value,
      city: document.getElementById('v-city').value.trim(),
      thaiProvince: document.getElementById('v-province').value || '',
      source: document.getElementById('v-source').value,
      consent: document.getElementById('v-consent').checked
    },
    staff: {
      staffName: document.getElementById('s-staff').value,
      ticketType: document.getElementById('s-ticket').value,
      ticketQty: document.getElementById('s-qty').value,
      amountPaid: document.getElementById('s-amount').value,
      payMethod: (document.querySelector('input[name=pay]:checked')||{}).value || ''
    },
    submittedAt: new Date().toISOString()
  };

  const btn = document.getElementById('finalize');
  const old = btn.textContent; btn.textContent='กำลังส่ง...'; btn.disabled=true;

  try{
    const res = await fetch(FORMSPREE_ENDPOINT, {
      method:'POST',
      headers:{ 'Content-Type':'application/json', 'Accept':'application/json' },
      body: JSON.stringify(payload)
    });
    if(!res.ok) throw new Error('Formspree HTTP '+res.status);
    show('v4'); // success
  }catch(err){
    console.error(err);
    toast('ส่งไม่สำเร็จ: ใช้ปุ่ม "ส่งแบบสำรอง" ได้');
  }finally{
    btn.textContent = old; btn.disabled=false;
  }
});

// Staff fallback → pure HTML POST (no CORS/JS needed)
document.getElementById('finalize-fallback').addEventListener('click', ()=>{
  const map = [
    ['f-submittedAt', new Date().toISOString()],
    ['f-v-email', document.getElementById('v-email').value.trim()],
    ['f-v-first', document.getElementById('v-first').value.trim()],
    ['f-v-last', document.getElementById('v-last').value.trim()],
    ['f-v-gender', document.getElementById('v-gender').value],
    ['f-v-age', document.getElementById('v-age').value],
    ['f-v-country', document.getElementById('v-country').value],
    ['f-v-city', document.getElementById('v-city').value.trim()],
    ['f-v-province', document.getElementById('v-province').value || ''],
    ['f-v-source', document.getElementById('v-source').value],
    ['f-v-consent', String(document.getElementById('v-consent').checked)],
    ['f-s-staff', document.getElementById('s-staff').value],
    ['f-s-ticket', document.getElementById('s-ticket').value],
    ['f-s-qty', document.getElementById('s-qty').value],
    ['f-s-amount', document.getElementById('s-amount').value],
    ['f-s-pay', (document.querySelector('input[name=pay]:checked')||{}).value || '']
  ];
  for (const [id,val] of map){ document.getElementById(id).value = val; }
  document.getElementById('fallback-form').submit(); // Navigate to Formspree thank-you page
});

// Back to start
document.getElementById('back-to-start').addEventListener('click', ()=>{
  document.getElementById('visitor-form').reset();
  document.getElementById('staff-form').reset();
  // rebuild countries after reset
  const c = document.getElementById('v-country');
  c.innerHTML = '<option value="">— เลือกประเทศ —</option>' + COUNTRIES.map(x=>`<option>{x}</option>`).join('');
  c.value = 'Thailand';
  const pr = document.getElementById('v-province');
  pr.innerHTML = THAI_PROVINCES.map(x=>`<option>{x}</option>`).join('');
  document.getElementById('thai-province-row').style.display='grid';
  show('v1');
});
</script>
</body>
</html>
